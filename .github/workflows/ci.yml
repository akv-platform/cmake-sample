name: Build
on: [push]
jobs:
  build:
    runs-on: macos-12

    steps:
    - run: sudo xcode-select --switch /Applications/Xcode_13.3.1.app
      name: select 13.3.1
      
    - run: |
        softwareupdate --list
        ls -la /Applications|grep Xcode
      name: Investigate
      
    - run: |
        softwareupdate --list
        xcrun --show-sdk-path --sdk macosx
      name: Repro
      
    - run: |        
        sudo xcode-select --switch /Applications/Xcode_13.3.1.app
        sudo rm -rf /Library/Developer/CommandLineTools
        xcode-select --install
        xcrun --show-sdk-path --sdk macosx
        sudo xcode-select --switch /Applications/Xcode_13.4.1.app
        sudo rm -rf /Library/Developer/CommandLineTools
        xcode-select --install
        xcrun --show-sdk-path --sdk macosx
      name: Fix
      
    - run: |        
        sudo xcode-select --switch /Applications/Xcode_13.2.1.app
        xcrun --show-sdk-path --sdk macosx
        sudo xcode-select --switch /Applications/Xcode_13.3.1.app
        xcrun --show-sdk-path --sdk macosx
      name: Test back and forth
      
    - run: |        
        sudo xcode-select --switch /Applications/Xcode_13.4.1.app
        xcrun --show-sdk-path --sdk macosx
      name: Test 13.4.1
      
    - run: |        
        sudo xcode-select --switch /Applications/Xcode_13.1.app
        xcrun --show-sdk-path --sdk macosx
      name: Test 13.1
      
    - run: |        
        sudo xcode-select --switch /Applications/Xcode_13.2.1.app
        xcrun --show-sdk-path --sdk macosx
      name: Test 13.2.1
      
    - run: |        
        sudo xcode-select --switch /Applications/Xcode_13.3.1.app
        xcrun --show-sdk-path --sdk macosx
      name: Test 13.3.1
